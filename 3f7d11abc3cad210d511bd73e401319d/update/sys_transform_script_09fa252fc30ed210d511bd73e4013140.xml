<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_transform_script">
    <sys_transform_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <map display_value="Extented SCAdb Map">608429e3c30ed210d511bd73e40131db</map>
        <order>100</order>
        <script><![CDATA[(function runTransformScript(source, map, log, target /*undefined onStart*/ ) {

    // Add your code here

    // Die Werte der Coalesce-Felder aus dem Quell-Datensatz (source) holen
    var feld1 = source.u_name; // Beispiel: field1
    var feld2 = 'Business Service'; // Beispiel: field2
    var feld3 = 'service_offering'; // Beispiel: field3

    // Prüfung, ob eine Übereinstimmung in der Zieltabelle (target) vorhanden ist
    var existingRecord = new GlideRecord('cmdb_ci_service'); // Ersetze 'target_table' durch den tatsächlichen Tabellenname
    existingRecord.addQuery('name', feld1);
    existingRecord.addQuery('service_classification', feld2);
    existingRecord.addQuery('sys_class_name', feld3);
    existingRecord.query();

    // Wenn kein passender Datensatz gefunden wird, den Import abbrechen
    if (!existingRecord.next()) {
        gs.info('Kein übereinstimmender Datensatz gefunden. Datensatz wird nicht angelegt.');
        ignore = true; // Dieser Parameter verhindert das Anlegen des Datensatzes

		/*
        // Prüfung, ob eine Übereinstimmung in der Zieltabelle (target) nur aufgrund des Namens vorhanden ist
        var existingNameRecord = new GlideRecord('cmdb_ci_service'); // Ersetze 'target_table' durch den tatsächlichen Tabellenname
        existingNameRecord.addQuery('name', feld1);
        //existingNameRecord.addQuery('service_classification', feld2);
        //existingNameRecord.addQuery('sys_class_name', feld3);
        existingNameRecord.query();

        if (existingNameRecord.next()) {
            gs.info('Ein {Name} übereinstimmender Datensatz gefunden. Datensatz wird nicht angelegt.' + existingNameRecord.name);
            //ignore = false; // Dieser Parameter verhindert das Anlegen des Datensatzes
        } else {
            gs.info('Kein {Name} übereinstimmender Datensatz gefunden. Datensatz wird nicht angelegt.' + feld1);	
			ignore = false;		// für den ersten Import
		}
		*/

    }



})(source, map, log, target);]]></script>
        <sys_class_name>sys_transform_script</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-11-29 15:30:38</sys_created_on>
        <sys_id>09fa252fc30ed210d511bd73e4013140</sys_id>
        <sys_mod_count>7</sys_mod_count>
        <sys_name>onBefore</sys_name>
        <sys_package display_value="AdB Data Source" source="3f7d11abc3cad210d511bd73e401319d">3f7d11abc3cad210d511bd73e401319d</sys_package>
        <sys_policy/>
        <sys_scope display_value="AdB Data Source">3f7d11abc3cad210d511bd73e401319d</sys_scope>
        <sys_update_name>sys_transform_script_09fa252fc30ed210d511bd73e4013140</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-12-02 08:11:14</sys_updated_on>
        <when>onBefore</when>
    </sys_transform_script>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>09fa252fc30ed210d511bd73e4013140</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-11-29 15:30:38</sys_created_on>
        <sys_id>400bedebc30ed210d511bd73e401315c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-11-29 15:30:38</sys_updated_on>
        <table>sys_transform_script</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
